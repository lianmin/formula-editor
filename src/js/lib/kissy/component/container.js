/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Aug 7 15:48
*/
KISSY.add("component/container",["util","component/control"],function(f,g,m,i){function j(b){var a=b.component,c=this.get("children"),b=b.index;c.splice(b,0,a);c=this.get("children");a=c[b];a.setInternal&&a.setInternal("parent",this);this.get("rendered")&&this.renderChild(b);this.fire("afterAddChild",{component:a,index:b})}function k(b){var a=b.component,c=b.destroy,d=this.get("children"),b=b.index;-1!==b&&d.splice(b,1);a.setInternal&&a.setInternal("parent",null);a.destroy?a.destroy(c):a.isNode&&
c&&a.remove();this.fire("afterRemoveChild",{component:a,index:b})}var h=g("util"),f=g("component/control"),l=f.Manager;i.exports=f.extend({isContainer:!0,initializer:function(){var b=this.get("prefixCls"),a=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:j,defaultTargetOnly:!0});this.publish("beforeRemoveChild",{defaultFn:k,defaultTargetOnly:!0});a.prefixCls=a.prefixCls||b},decorateDom:function(){var b=this,a=b.getChildrenContainerEl(),c=b.get("defaultChildCfg"),d=c.prefixCls,
e=c.xclass,f=[];a.children().each(function(a){var g=b.getComponentConstructorByNode(d,a)||e&&l.getConstructorByXClass(e);g?f.push(new g(h.merge(c,{srcNode:a}))):f.push(a)});b.set("children",f)},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var b,a=this.get("children");for(b=0;b<a.length;b++)this.renderChild(b)},createChildren:function(){var b,a=this.get("children");for(b=0;b<a.length;b++)this.createChild(b)},addChild:function(b,a){var c=
this.get("children");void 0===a&&(a=c.length);this.fire("beforeAddChild",{component:b,index:a});return c[a]},renderChild:function(b){var a=this.get("children"),c=this.createChild(b);c.isNode||c.render();this.fire("afterRenderChild",{component:a[b],index:b})},createChild:function(b){var a,c,d,e;a=this.get("children")[b];e=this.getChildrenContainerEl();d=e[0];c=d.children[b]||null;a.isNode?(e=a.isNode?a[0]:a.el,e.parentNode!==d&&d.insertBefore(e,c)):a.get("rendered")?(e=a.isNode?a[0]:a.el,e.parentNode!==
d&&d.insertBefore(e,c)):(c?a.set("elBefore",c):a.set("render",e),a.create());this.fire("afterCreateChild",{component:a,index:b});return a},addChildren:function(b){var a,c=b.length;for(a=0;a<c;a++)this.addChild(b[a])},removeChild:function(b,a){void 0===a&&(a=!0);this.fire("beforeRemoveChild",{component:b,index:h.indexOf(b,this.get("children")),destroy:a})},removeChildren:function(b){var a,c=[].concat(this.get("children"));for(a=0;a<c.length;a++)this.removeChild(c[a],!1);!1!==b&&this.$el&&(this.getChildrenContainerEl()[0].innerHTML=
"");return this},getChildAt:function(b){return this.get("children")[b]||null},getChildrenContainerEl:function(){return this.$el},destructor:function(b){this.removeChildren(b)}},{ATTRS:{children:{valueFn:function(){return[]},getter:function(b){var a=null,c,d;for(c=0;c<b.length;c++)d=b[c],!d.isControl&&!d.isNode&&(a=a||this.get("defaultChildCfg"),h.mix(d,a,!1),b[c]=this.createComponent(d));return b},setter:function(b){var a,c;for(a=0;a<b.length;a++)c=b[a],c.isControl&&c.setInternal("parent",this)}},
defaultChildCfg:{valueFn:function(){return{}}}},name:"container"})});
